# Auto-Init Template System

This directory contains framework-specific templates for the `/init-claude` command. Templates are used to generate project-specific CLAUDE.md and AGENT.md files with best practices and patterns for each framework.

## Available Templates

| Template | Framework | Description |
|----------|-----------|-------------|
| `nextjs.template.md` | Next.js 14+ | App Router, Server Components, Route Handlers, Metadata API |
| `react-vite.template.md` | React 18 + Vite | Component patterns, Hooks, State management, HMR |
| `fastapi.template.md` | FastAPI | Async/await, Pydantic v2, Type hints, Dependency injection |
| `django.template.md` | Django | ORM patterns, Migrations, Admin, Apps structure |
| `go.template.md` | Go | Modules, Goroutines, Error handling, Testing |
| `generic.template.md` | Universal | Fallback for unknown frameworks |
| `agent.template.md` | Agent Guide | Optional AGENT.md generation |

## Template Structure

Templates use a simple placeholder syntax with `{{PLACEHOLDER}}` markers:

### Available Placeholders

```markdown
{{PROJECT_NAME}}          - Name of the project
{{FRAMEWORK}}             - Detected framework name
{{FRAMEWORK_VERSION}}     - Framework version
{{PACKAGE_MANAGER}}       - npm, yarn, pnpm, uv, etc.
{{TEST_FRAMEWORK}}        - Detected test framework
{{ROUTER_TYPE}}           - App Router, Pages Router, etc.
{{DEPENDENCIES_LIST}}     - Top 10 project dependencies
{{GENERATED_DATE}}        - Date template was generated
```

### Conditional Sections

Templates support conditional sections for framework-specific content:

```markdown
{{#IF SERVER_COMPONENTS}}
Content only shown when server components are detected
{{/IF}}

{{#IF ASYNC_SUPPORT}}
Async-specific guidance
{{/IF}}
```

## Customizing Templates

### Project-Level vs User-Level

**Important Distinction:**
- **User-level templates** (this directory): Apply to ALL projects you work on
- **Project-level templates**: Would be in each project's local `.claude/` directory (not implemented)

This integration is **user-level only**, meaning:
- Templates in `C:\Users\Patrick\.claude\templates\auto-init/` apply globally
- Changes here affect all future `/init-claude` runs
- Project-specific customizations must be done after generation

### How to Customize

1. **Edit existing templates:**
   ```bash
   # Open a template in your editor
   code C:\Users\Patrick\.claude\templates\auto-init\nextjs.template.md
   ```

2. **Add placeholders:**
   - Define new variables in `selector.ps1` (`$variables` object)
   - Use `{{YOUR_VARIABLE_NAME}}` in templates
   - Variables are case-sensitive

3. **Add conditional sections:**
   ```markdown
   {{#IF YOUR_CONDITION}}
   Conditional content here
   {{/IF}}
   ```

4. **Test your changes:**
   ```bash
   # Navigate to a test project
   cd C:\Users\Patrick\Playground\test-project

   # Run init-claude in Claude Code
   /init-claude
   ```

## Adding New Framework Templates

To add support for a new framework:

### 1. Create Template File

Create `frameworks/your-framework.template.md` in this directory:

```markdown
# PROJECT MEMORY - {{PROJECT_NAME}}

## Project Overview
- **Framework**: {{FRAMEWORK}} {{FRAMEWORK_VERSION}}
- **Type**: [Your framework type]
- **Package Manager**: {{PACKAGE_MANAGER}}

## Framework-Specific Patterns

[Your framework best practices here]

## Dependencies
- {{DEPENDENCIES_LIST}}

---
*Generated by CLAUDE.md Auto-Init System on {{GENERATED_DATE}}*
```

### 2. Update Template Mapping

Edit `C:\Users\Patrick\.claude\scripts\auto-init\selector.ps1`:

```powershell
# Template mapping (around line 40)
$templateMap = @{
    # ... existing mappings ...
    "your-framework"  = "your-framework.template.md"
}
```

### 3. Update Framework Detection

Edit `C:\Users\Patrick\.claude\scripts\auto-init\scanner.ps1`:

Add detection logic for your framework in the `Detect-Framework` function:

```powershell
# Check for Your Framework
if (Test-Path (Join-Path $projectPath "your-framework.config")) {
    return @{
        name = "Your Framework"
        version = "1.0.0"  # Extract from config
        projectType = "your-framework"
        confidence = 95
    }
}
```

### 4. Add Framework-Specific Variables (Optional)

In `selector.ps1`, add framework-specific variables:

```powershell
switch ($scanResult.projectType) {
    "your-framework" {
        $variables.YOUR_CUSTOM_VAR = $true
        $variables.ANOTHER_VAR = "value"
    }
}
```

### 5. Test the New Template

```bash
# Create a test project with your framework
mkdir test-your-framework
cd test-your-framework

# Add framework-specific files to trigger detection
touch your-framework.config

# Run auto-init
/init-claude
```

## Template Best Practices

### 1. **Keep it Framework-Specific**
   - Include actual framework patterns, not generic advice
   - Reference real APIs, imports, and idioms
   - Provide copy-pasteable code examples

### 2. **Use Placeholders Wisely**
   - Don't overuse placeholders - hard-code when appropriate
   - Group related variables together
   - Document custom placeholders in comments

### 3. **Organize by Sections**
   - Project Overview
   - Framework Patterns
   - Testing Approach
   - File Structure
   - Common Tasks
   - Dependencies

### 4. **Balance Detail vs. Brevity**
   - Enough detail to be useful immediately
   - Brief enough to read in < 5 minutes
   - Link to external docs for deep dives

### 5. **Version Awareness**
   - Use `{{FRAMEWORK_VERSION}}` for version-specific guidance
   - Add conditional sections for version-specific features
   - Keep templates updated with framework evolution

## Security Considerations

Templates undergo security validation before generation:

1. **Secret Detection**: Templates are scanned for API keys, tokens, passwords
2. **Path Validation**: Only whitelisted paths can be written to
3. **Backup Creation**: Existing files are backed up before overwrite

**Never include actual secrets in templates.**

Use environment variable references instead:

```markdown
## Configuration

- API Key: `process.env.API_KEY`
- Database URL: `process.env.DATABASE_URL`
```

## Troubleshooting

### Template Not Found

```
Error: Template not found: nextjs.template.md
```

**Solution**: Verify template exists:
```bash
ls C:\Users\Patrick\.claude\templates\auto-init\
```

### Placeholder Not Replaced

```
Generated file contains: {{PROJECT_NAME}}
```

**Solution**: Check variable is defined in `selector.ps1` and matches exactly (case-sensitive)

### Conditional Not Working

```markdown
{{#IF SERVER_COMPONENTS}}
Still showing even when false
{{/IF}}
```

**Solution**: Ensure variable is boolean, not string:
```powershell
$variables.SERVER_COMPONENTS = $true  # Not "true"
```

## Examples

### Example 1: Adding TypeScript Strictness Level

1. **Update `selector.ps1`:**
   ```powershell
   # Extract tsconfig settings
   if (Test-Path (Join-Path $scanResult.projectPath "tsconfig.json")) {
       $tsconfig = Get-Content -Path (Join-Path $scanResult.projectPath "tsconfig.json") | ConvertFrom-Json
       $variables.TS_STRICT = $tsconfig.compilerOptions.strict
   }
   ```

2. **Use in template:**
   ```markdown
   {{#IF TS_STRICT}}
   - **TypeScript**: Strict mode enabled
   {{/IF}}
   ```

### Example 2: Custom Project Type Template

For a Rust + Actix Web project:

1. **Create `rust-actix.template.md`**
2. **Update scanner to detect `Cargo.toml` with `actix-web` dependency**
3. **Map `"rust-actix"` to template in selector**
4. **Add Rust-specific variables (edition, features)**

## Contributing

To contribute template improvements:

1. Test changes locally first
2. Document new placeholders in this README
3. Ensure backwards compatibility
4. Follow existing template structure

---

**Version**: 1.0.0
**Last Updated**: 2025-12-15
**Maintainer**: Patrick (patichu0101)
